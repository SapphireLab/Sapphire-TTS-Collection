# Slamming

<details>
<summary>基本信息</summary>

- 标题: "Slamming: Training a Speech Language Model on One GPU in a Day"
- 作者:
  - 01 Gallil Maimon,
  - 02 Avishai Elmakies,
  - 03 Yossi Adi
- 链接:
  - [ArXiv](https://arxiv.org/abs/2502.15814)
  - [Publication]()
  - [Github](https://github.com/slp-rl/slamkit)
  - [Demo](https://pages.cs.huji.ac.il/adiyoss-lab/slamming/)
- 文件:
  - [ArXiv](_PDF/2502.15814v1__Slamming__Training_a_Speech_Language_Model_on_One_GPU_in_a_Day.pdf)
  - [Publication] #TODO

</details>

## Abstract: 摘要

<table><tr><td width="50%">

We introduce ***Slam***, a recipe for training high-quality Speech Language Models (SLMs) on a single academic GPU in 24 hours.
We do so through empirical analysis of model initialization and architecture, synthetic training data, preference optimization with synthetic data and tweaking all other components.
We empirically demonstrate that this training recipe also scales well with more compute getting results on par with leading SLMs in a fraction of the compute cost.
We hope these insights will make SLM training and research more accessible.
In the context of SLM scaling laws, our results far outperform predicted compute optimal performance, giving an optimistic view to SLM feasibility.
See code, data, models, samples - https://pages.cs.huji.ac.il/adiyoss-lab/slamming.

</td><td>

</td></tr></table>

## 1·Introduction: 引言

<table><tr><td width="50%">

Speech Language Models (SLMs) have gained significant interest from researchers~\cite{peng2024survey, cui2024recent, ji2024wavchat, latif2023sparks}, demonstrating remarkable performance in traditional speech tasks~\cite{valle, elmakies2025unsupervisedspeechsegmentationgeneral}, diverse generative applications~\cite{yang2023uniaudio, yang2024uniaudio}, and reasoning over speech and audio signals~\cite{salmonn, qwen_audio}.

SLMs can generally be classified into two main categories: (i) generative speech LMs (which can also incorporate text) and (ii) speech-aware LMs.
The first category follows a similar pre-training approach to text-based LLMs, directly maximizing the likelihood of speech considering both input and output, typically by representing audio as a sequence of discrete tokens.
The second category consists of pre-trained text LMs adapted to process speech inputs.
In this work, we focus on the first.

Training high-quality SLMs can be highly resource intensive~\cite{twist, cuervo2024scaling, scaling_interleaving, spiritlm, defossez2024moshi}.
For example, ~\citet{spiritlm} trained their SLM on approximately $570k$ hours of speech data, while ~\citet{defossez2024moshi} utilized around $7M$ hours.
Additionally, ~\citet{cuervo2024scaling} proposed SLM scaling laws, suggesting that training high-quality SLMs requires $\sim3X$ more data compared to text-based counterparts.
These computational demands restrict the required fundamental research aimed at enhancing SLMs, such as advancements in speech tokenization, efficient acoustic modelling, etc.

In the Natural Language Processing (NLP) community, numerous studies have investigated efficient model training techniques, including masked language models such as Cramming~\citep{geiping2023cramming} and ModernBERT~\citep{warner2024modernbert}, along with next-token prediction LLMs such as MobileLLM~\citep{mobilellm}.
These methods include implementation efficiencies, architectural improvements, data selection strategies, and enhancements to the overall training pipeline.

Inspired by Cramming~\cite{geiping2023cramming} in text, we investigate compute-limited SLM training, which we term ***Slamming***.
We pose the question: \emph{Is it possible to train high-quality SLMs using a single GPU within 24 hours?} For that, we conduct an extensive empirical analysis exploring how different training components influence performance.
From this, we derive a training recipe that maximizes model performance within a fixed compute budget.
Specifically, we investigate the impact of model initialization and architecture, various optimizers and learning rate schedulers, data selection strategies - including the role of synthetic data, text-interleaving and preference optimization.

We believe that developing these training strategies and proving their feasibility will empower the speech and audio research community to advance SLMs beyond the scope of large, well-funded academic and industrial labs.
Figure~\ref{fig:teaser} illustrates the performance of various SLMs relative to their training compute budget, with circle sizes representing the size of the models.
Furthermore, we compare our results with the scaling performance predicted from \citet{cuervo2024scaling}.
Although the authors present a somewhat pessimistic view of the computational resources needed to train high-quality SLMs, we empirically show that reality is more promising, demonstrating that it is possible to significantly exceed the predicted performance per unit of compute.
We encourage the community to refine and expand scaling laws specifically tailored for SLM training across various settings.

Our main contributions are:
- We introduce \method, a training recipe for efficiently training high-quality SLMs using a single $A5000$ GPU within $24$ hours.
- We carry out extensive experiments exploring model initialization and architecture, optimization, data collection and generation, and training objectives (i.e., preference optimization and text-speech interleaving), providing insights into the impact of each component on model performance.
- Building on these insights, we scale the compute budget to two $A100$ GPUs for $48$ hours and demonstrate that our model achieves performance on par with state-of-the-art models that require substantially more compute.

We open-source all code, models, training recipes, and synthetic datasets.

</td><td>

</td></tr></table>

## 2·Related Works: 相关工作

<table><tr><td width="50%">

**Efficient training.**

Enhancing the efficiency of neural network training has been extensively studied~\citep{shen2023efficient}.
\citet{hajimolahoseini2023swiftlearn, wang2024greats} examined the impact of data selection on LLM training and introduced efficient data selection methods.
\citet{muhamed2024grass} proposed using structured sparse gradients to enhance compute efficiency in LLM training, while \citet{rawat2024little} explored the potential of leveraging smaller language models to improve the training efficiency of larger LLMs.
\citet{lv2024scalable} investigated the use of low-dimensional projections for attention parameters to enhance training efficiency.
Meanwhile, \citet{neiterman2024layerdropback} proposed applying LayerDrop as a technique to optimise neural network training.

More closely related to our work, \citet{li2023flm} propose a training strategy for developing LLMs within a $100k\$$ budget.
\citet{warner2024modernbert} introduce ModernBERT, an efficient training pipeline for optimising BERT models, while \citet{izsak2021train} outline a method for training a BERT model in $24$ hours using $8$ GPUs.
The most relevant work to ours is Cramming \cite{geiping2023cramming}, where the authors conduct an in-depth analysis of masked LM training on a single GPU in one day.

While these studies offer valuable insights, they primarily focus on training text models, such as LLMs and masked LMs.
In the speech domain, similar research has been conducted on self-supervised representation models~\citep{liu2024efficient}, but not on SLMs.
In this work, we address this gap by focusing on efficient SLM training.

</td><td>

</td></tr>
<tr><td>

**Generative speech language models** were explored under various setups~\citep{gslm, kharitonov2021text}.
\citet{gslm} were the first to show how raw and uncurated speech data can be leveraged into building a GSLM system.
Next,~\citet{borsos2023audiolm} proposed a cascade version using both coarse and fine speech tokens.
Such a modelling framework opened up a new and promising research direction for processing and modelling spoken data, such as speech resynthesis~\citep{polyak2021speech}, speaking style conversion~\citep{kreuk2021textless,maimon2023dissc}, dialogue modelling~\cite{nguyen2022generative}, speech-to-speech translation~\citep{popuri2022enhanced, peng2024mslm}, etc.

\citet{nachmani2023spoken} proposed augmenting a text LM with continuous speech data to improve spoken question-answering tasks.
Recently, \citet{park2024long} proposed SLM based on state-space models~\citep{gu2021efficiently} to further push long context-efficient modelling, while ~\citet{lin2024alignslm} proposed to fine-tune SLMs using direct preference optimisation~\citep{rafailov2024dpo} obtained from text LLM rankings.

Similar to text LLMs, training SLMs often demands large-scale datasets.
For instance, Moshi~\cite{defossez2024moshi} was trained on $7$ million hours of speech data, SpiritLM~\cite{spiritlm} utilized $560k$ hours, and TWIST~\cite{twist} was trained on approximately $150k$.
Recently, \citet{cuervo2024scaling} introduced the first scaling laws for SLMs, suggesting that achieving comparable performance to text LMs requires three times more tokens.
In this work, we focus on reducing the computational demands while maintaining performance comparable to leading SLMs.

</td><td>

</td></tr></table>

## 3·Setup: 设置

<table><tr><td width="50%">

</td><td>

</td></tr></table>

## 4·Investigations: 研究

<table><tr><td width="50%">

</td><td>

</td></tr></table>

## 5·Final Recipe: 最终配方

<table><tr><td width="50%">

</td><td>

</td></tr></table>

## 6·Increasing Compute: 增加计算

<table><tr><td width="50%">

</td><td>

</td></tr></table>

## 7·Conclusions: 结论

<table><tr><td width="50%">

</td><td>

</td></tr></table>
